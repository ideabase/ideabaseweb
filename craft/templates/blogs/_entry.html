{#
 # Blogs entry template
 #}

{% extends "_layout" %}

{% block content %}

{% if entry.blogFeaturedImage | length %}
<section class="section-header-blog-basic-page">
		{% for asset in entry.blogFeaturedImage %}
		<picture>
		  <source media="(max-width: 639px)" srcset="{{ asset.getUrl('featureImageSmall') }}" >
		  <source media="(min-width: 1024px)" srcset="{{ asset.getUrl('featureImageLarge') }}">
		  <source media="(min-width: 640px)" srcset="{{ asset.getUrl('featureImageMedium') }}">
		  <img class="blog__entry__image" srcset="{{ asset.getUrl('featureImageLarge') }}" alt= "{{ asset.title}}">
		</picture>
		{% endfor %}
</section>
{% endif %}
<div class="panel-primary-container">
    <section class="section-blog-entry panel-primary">
	<article class="blog__entry">
		<h1 class="blog__entry__title">{{ entry.title }}</h1>
		<span class="blog__entry__author">
			{% for entry in entry.blogAuthor %}
			{{ entry.title }}
			{% endfor %}
		</span>
		<span class="blog__entry__date">Posted on {{ entry.postDate.format('F d, Y') }}</span>
		<div class="blog__entry__text">
			{{ entry.blogContent}}
			{% for block in entry.blogPostContent %}

			    {% if block.type == "text" %}
			        {{ block.text }}

			    {% elseif block.type == "image" %}

			        {% set image = block.image.first() %}
			        {% if image %}
			        	<section class="section-body-image panel-primary">
			        		<figure class="section-body-image__figure">
			        			<img class="section-body-image__image" src="{{ image.getUrl('thumb') }}" alt="{{ image.title }}" />
			        			<figcaption class="section-body-image__caption">{{ image.caption }}</figcaption>
			        		</figure>
			        	</section>
			        {% endif %}

			    {% elseif block.type == "video" %}

			    <section class="section-body-video panel-primary">
			    	<figure class="section-body-video__figure">
			    		{{ block.videoURL|raw }}
			    		<figcaption class="section-body-image__caption">{{ block.videoCaption }}</figcaption>
			    	</figure>
			    </section>

			    {% elseif block.type == "pullQuote" %}

			        <section class="testimonial-entry panel-primary">
			        		<blockquote class="testimonial-entry__text">{{ block.pullQuote }}
			        		</blockquote>	
			        		<cite class="testimonial-entry__author">{{ block.pullQuoteAuthor }}</cite>
			        </section>

			    {% endif %}

			{% endfor %}
		</div>
	</article>
	<aside class="blog__entry__sidebar">
		{% for entry in entry.blogAuthor %}
		<section class="blog__entry-author">
			<div class="blog__entry__author__image">
				{% for asset in entry.staffHeadshot %}
			     	<img src="{{ asset.getUrl('staffCircle') }}" alt= "{{ asset.title}}">
			   	{% endfor %}
			 </div>
			 <span class="blog__entry__author__name">{{ entry.title }}
			 </span>
			<span class="blog__entry__author__info">{{entry.profileJobTitle }}</span>
			<div class="blog__entry__author__description">
			{% set bioParagraphs = entry.profileBiographyDescription|split('</p>') %}
			{% set firstBioParagraph = bioParagraphs|first ~ '</p>' %}
	    		{{ firstBioParagraph|raw }}
			</div>
			<a href="{{ entry.url }}" class="blog-teaser__link blog-teaser__link--blog">Read More About {{ entry.profileFirstName }}</a>   
		</section>		
		{% endfor %}
		{% set tag = entry.blogTags %}
		{% set relatedEntries = craft.entries.relatedTo(tag).id('not ' ~ currentEntry.id).limit(3).order('RAND()').find() %}	
			{% if relatedEntries | length %}
			<section class="people-posts people-posts--blog">
			<h2 class="people-posts__title">Related Posts</h2>
			<ul class="people-posts__list">
			    {% for entry in relatedEntries %}
			        <li class="people-posts__list__item">
			        	<a href="{{ entry.url }}">
			        		{{ entry.title }}
			        	</a>
			        </li>		
			    {% endfor %}
			</ul>
			</section> 
			{% endif %}

	<!-- Begin Tags -->
	{% if entry.blogTags | length %}
	<strong class="blog__entry__tags__title">Tags:</strong>
	<ul class="blog__entry__tags">
    	{% for tag in entry.blogTags %}
    		<li class="blog__entry__tags__single">
          		{{ tag.title }}
      		</li>
      	{% endfor %}
    </ul>	
    {% endif %}	
		<a class="button button-primary button--reverse" href="{{ siteUrl }}blog">Back to Blog</a>	
	</aside>
	</section>
</div>

	{% endblock %}