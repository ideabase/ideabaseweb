{"version":3,"sources":["CraftAssetFiles.js"],"names":["plugin","$","extend","Craft","Redactor","PluginBase","title","apiTarget","icon","volumes","showModal","this","app","selection","save","assetSelectionModal","arguments","refHandle","createElementSelectorModal","storageKey","sources","criteria","siteId","elementSiteId","onSelect","proxy","elements","length","restore","element","getText","data","url","id","text","label","api","closeOtherModals","show","setVolumes","add"],"mappings":"AAAA,IAAIA,OAASC,EAAEC,OAAO,GAAIC,MAAMC,SAASC,WAAY,CACjDC,MAAO,OACPC,UAAW,mCACXC,KAAM,+BACNC,QAAS,KAETC,UAAW,WAGP,GAFAC,KAAKC,IAAIC,UAAUC,YAEqB,IAA7BH,KAAKI,oBAAqC,CACjCC,UAAUC,UAC1BN,KAAKI,oBAAsBZ,MAAMe,2BAA2B,yBAA0B,CAClFC,WAAY,4BACZC,QAAST,KAAKF,QACdY,SAAU,CAACC,OAAQX,KAAKY,eACxBC,SAAUvB,EAAEwB,MAAM,SAASC,GACvB,GAAIA,EAASC,OAAQ,CACjBhB,KAAKC,IAAIC,UAAUe,UACnB,IAAIC,EAAUH,EAAS,GACnBb,EAAYF,KAAKC,IAAIC,UAAUiB,UAC/BC,EAAO,CACHC,IAAKH,EAAQG,IAAM,UAAYH,EAAQI,GACvCC,KAAyB,EAAnBrB,EAAUc,OAAad,EAAYgB,EAAQM,OAEzDxB,KAAKC,IAAIwB,IAAI,qBAAsBL,KAExCpB,MACH0B,kBAAkB,SAItB1B,KAAKI,oBAAoBuB,QAIjCC,WAAY,SAAU9B,GAClBE,KAAKF,QAAUA,KAMpBL,SADIoC,IAAI,SAAU,kBAAmBxC","file":"CraftAssetFiles.min.js","sourcesContent":["var plugin = $.extend({}, Craft.Redactor.PluginBase, {\r\n    title: 'file',\r\n    apiTarget: 'plugin.craftAssetFiles.showModal',\r\n    icon: '<i class=\"re-icon-file\"></i>',\r\n    volumes: null,\r\n\r\n    showModal: function () {\r\n        this.app.selection.save();\r\n\r\n        if (typeof this.assetSelectionModal === 'undefined') {\r\n            var refHandle = arguments.refHandle;\r\n            this.assetSelectionModal = Craft.createElementSelectorModal('craft\\\\elements\\\\Asset', {\r\n                storageKey: 'RedactorInput.LinkToAsset',\r\n                sources: this.volumes,\r\n                criteria: {siteId: this.elementSiteId},\r\n                onSelect: $.proxy(function(elements) {\r\n                    if (elements.length) {\r\n                        this.app.selection.restore();\r\n                        var element = elements[0],\r\n                            selection = this.app.selection.getText(),\r\n                            data = {\r\n                                url: element.url + '#asset:' + element.id,\r\n                                text: selection.length > 0 ? selection : element.label\r\n                            };\r\n                        this.app.api('module.link.insert', data);\r\n                    }\r\n                }, this),\r\n                closeOtherModals: false,\r\n            });\r\n        }\r\n        else {\r\n            this.assetSelectionModal.show();\r\n        }\r\n    },\r\n\r\n    setVolumes: function (volumes) {\r\n        this.volumes = volumes;\r\n    }\r\n});\r\n\r\n(function($R) {\r\n    $R.add('plugin', 'craftAssetFiles', plugin);\r\n})(Redactor);"]}