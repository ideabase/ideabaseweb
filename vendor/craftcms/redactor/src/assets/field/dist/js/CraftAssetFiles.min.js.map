{"version":3,"sources":["CraftAssetFiles.js"],"names":["plugin","$","extend","Craft","Redactor","PluginBase","title","apiTarget","icon","volumes","showModal","this","app","selection","isCollapsed","save","selectionMarkers","saveMarkers","assetSelectionModal","arguments","refHandle","createElementSelectorModal","storageKey","sources","criteria","siteId","elementSiteId","onSelect","proxy","elements","length","restoreMarkers","restore","element","getText","data","url","id","text","label","api","closeOtherModals","show","setVolumes","add"],"mappings":"AAAA,IAAIA,OAASC,EAAEC,UAAWC,MAAMC,SAASC,YACrCC,MAAO,OACPC,UAAW,mCACXC,KAAM,+BACNC,QAAS,KAETC,UAAW,WASP,GARIC,KAAKC,IAAIC,UAAUC,eACnBH,KAAKC,IAAIC,UAAUE,OACnBJ,KAAKC,IAAII,kBAAmB,IAE5BL,KAAKC,IAAIC,UAAUI,cACnBN,KAAKC,IAAII,kBAAmB,QAGQ,IAA7BL,KAAKO,oBAAqC,CACjCC,UAAUC,UAC1BT,KAAKO,oBAAsBf,MAAMkB,2BAA2B,0BACxDC,WAAY,4BACZC,QAASZ,KAAKF,QACde,UAAWC,OAAQd,KAAKe,eACxBC,SAAU1B,EAAE2B,MAAM,SAASC,GACvB,GAAIA,EAASC,OAAQ,CACbnB,KAAKC,IAAII,iBACTL,KAAKC,IAAIC,UAAUkB,iBAEnBpB,KAAKC,IAAIC,UAAUmB,UAGvBrB,KAAKC,IAAII,kBAAmB,EAE5B,IAAIiB,EAAUJ,EAAS,GACnBhB,EAAYF,KAAKC,IAAIC,UAAUqB,UAC/BC,GACIC,IAAKH,EAAQG,IAAM,UAAYH,EAAQI,GACvCC,KAAyB,EAAnBzB,EAAUiB,OAAajB,EAAYoB,EAAQM,OAEzD5B,KAAKC,IAAI4B,IAAI,qBAAsBL,KAExCxB,MACH8B,kBAAkB,SAItB9B,KAAKO,oBAAoBwB,QAIjCC,WAAY,SAAUlC,GAClBE,KAAKF,QAAUA,KAMpBL,SADIwC,IAAI,SAAU,kBAAmB5C","file":"CraftAssetFiles.min.js","sourcesContent":["var plugin = $.extend({}, Craft.Redactor.PluginBase, {\n    title: 'file',\n    apiTarget: 'plugin.craftAssetFiles.showModal',\n    icon: '<i class=\"re-icon-file\"></i>',\n    volumes: null,\n\n    showModal: function () {\n        if (this.app.selection.isCollapsed()) {\n            this.app.selection.save();\n            this.app.selectionMarkers = false;\n        } else {\n            this.app.selection.saveMarkers();\n            this.app.selectionMarkers = true;\n        }\n\n        if (typeof this.assetSelectionModal === 'undefined') {\n            var refHandle = arguments.refHandle;\n            this.assetSelectionModal = Craft.createElementSelectorModal('craft\\\\elements\\\\Asset', {\n                storageKey: 'RedactorInput.LinkToAsset',\n                sources: this.volumes,\n                criteria: {siteId: this.elementSiteId},\n                onSelect: $.proxy(function(elements) {\n                    if (elements.length) {\n                        if (this.app.selectionMarkers) {\n                            this.app.selection.restoreMarkers();\n                        } else {\n                            this.app.selection.restore();\n                        }\n\n                        this.app.selectionMarkers = false;\n\n                        var element = elements[0],\n                            selection = this.app.selection.getText(),\n                            data = {\n                                url: element.url + '#asset:' + element.id,\n                                text: selection.length > 0 ? selection : element.label\n                            };\n                        this.app.api('module.link.insert', data);\n                    }\n                }, this),\n                closeOtherModals: false,\n            });\n        }\n        else {\n            this.assetSelectionModal.show();\n        }\n    },\n\n    setVolumes: function (volumes) {\n        this.volumes = volumes;\n    }\n});\n\n(function($R) {\n    $R.add('plugin', 'craftAssetFiles', plugin);\n})(Redactor);"]}