{"version":3,"sources":["CraftAssetImages.js"],"names":["plugin","$","extend","Craft","Redactor","PluginBase","title","apiTarget","icon","transforms","volumes","showModal","this","app","selection","save","assetSelectionModal","createElementSelectorModal","storageKey","multiSelect","sources","criteria","siteId","elementSiteId","kind","onSelect","proxy","assets","transform","length","restore","i","asset","url","id","data","api","closeOtherModals","show","setTransforms","setVolumes","add"],"mappings":"AAAA,IAAIA,OAASC,EAAEC,OAAO,GAAIC,MAAMC,SAASC,WAAY,CACjDC,MAAO,QACPC,UAAW,oCACXC,KAAM,gCACNC,WAAY,GACZC,QAAS,KAETC,UAAW,WACPC,KAAKC,IAAIC,UAAUC,YAEqB,IAA7BH,KAAKI,oBACZJ,KAAKI,oBAAsBb,MAAMc,2BAA2B,yBAA0B,CAClFC,WAAY,4BACZC,aAAa,EACbC,QAASR,KAAKF,QACdW,SAAU,CAACC,OAAQV,KAAKW,cAAeC,KAAM,SAC7CC,SAAUxB,EAAEyB,MAAM,SAASC,EAAQC,GAC/B,GAAID,EAAOE,OAAQ,CACfjB,KAAKC,IAAIC,UAAUgB,UACnB,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAOE,OAAQE,IAAK,CACpC,IAAIC,EAAQL,EAAOI,GACfE,EAAMD,EAAMC,IAAM,UAAYD,EAAME,GAEpCN,IACAK,GAAO,cAAgBL,GAG3B,IAAIO,EAAO,GACXA,EAAK,QAAQH,EAAME,IAAM,CACrBD,IAAKA,EACLC,GAAIF,EAAME,IAGdtB,KAAKC,IAAIuB,IAAI,sBAAuBD,MAG7CvB,MACHyB,kBAAkB,EAClB5B,WAAYG,KAAKH,aAIrBG,KAAKI,oBAAoBsB,QAIjCC,cAAe,SAAU9B,GACrBG,KAAKH,WAAaA,GAGtB+B,WAAY,SAAU9B,GAClBE,KAAKF,QAAUA,KAMpBN,SADIqC,IAAI,SAAU,mBAAoBzC","file":"CraftAssetImages.min.js","sourcesContent":["var plugin = $.extend({}, Craft.Redactor.PluginBase, {\r\n    title: 'image',\r\n    apiTarget: 'plugin.craftAssetImages.showModal',\r\n    icon: '<i class=\"re-icon-image\"></i>',\r\n    transforms: [],\r\n    volumes: null,\r\n\r\n    showModal: function () {\r\n        this.app.selection.save();\r\n\r\n        if (typeof this.assetSelectionModal === 'undefined') {\r\n            this.assetSelectionModal = Craft.createElementSelectorModal('craft\\\\elements\\\\Asset', {\r\n                storageKey: 'RedactorInput.ChooseImage',\r\n                multiSelect: true,\r\n                sources: this.volumes,\r\n                criteria: {siteId: this.elementSiteId, kind: 'image'},\r\n                onSelect: $.proxy(function(assets, transform) {\r\n                    if (assets.length) {\r\n                        this.app.selection.restore();\r\n                        for (var i = 0; i < assets.length; i++) {\r\n                            var asset = assets[i],\r\n                                url = asset.url + '#asset:' + asset.id;\r\n\r\n                            if (transform) {\r\n                                url += ':transform:' + transform;\r\n                            }\r\n\r\n                            var data = {};\r\n                            data['asset'+asset.id] = {\r\n                                url: url,\r\n                                id: asset.id\r\n                            };\r\n\r\n                            this.app.api('module.image.insert', data);\r\n                        }\r\n                    }\r\n                }, this),\r\n                closeOtherModals: false,\r\n                transforms: this.transforms\r\n            });\r\n        }\r\n        else {\r\n            this.assetSelectionModal.show();\r\n        }\r\n    },\r\n\r\n    setTransforms: function (transforms) {\r\n        this.transforms = transforms;\r\n    },\r\n\r\n    setVolumes: function (volumes) {\r\n        this.volumes = volumes;\r\n    }\r\n});\r\n\r\n(function($R) {\r\n    $R.add('plugin', 'craftAssetImages', plugin);\r\n})(Redactor);"]}