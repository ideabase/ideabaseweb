var plugin=$.extend({},Craft.Redactor.PluginBase,{assetId:null,start:function(){},open:function(e){this.assetId=e;var t={allowSavingAsNew:!1,onSave:this.reloadImage.bind(this),allowDegreeFractions:Craft.isImagick};new Craft.AssetImageEditor(e,t)},reloadImage:function(){var e=this.app.editor.getElement().find("[data-image]"),t=function(t){var a=t.src.match(/(.*)#asset:(\d+)(:transform:(.*))?/i);if(a&&a[2]==this.assetId)if(a[4]){var e={assetId:a[2],handle:a[4]};Craft.postActionRequest("assets/generate-transform",e,function(e){t.src=e.url+"?"+(new Date).getTime()+"#asset:"+a[2]+":transform:"+a[4]})}else t.src=a[1]+"?"+(new Date).getTime()+"#asset:"+a[2]}.bind(this);for(var a in e.nodes)t(a=e.nodes[a]);this.app.storage.observeImages()}});Redactor.add("plugin","craftAssetImageEditor",plugin);
//# sourceMappingURL=CraftAssetImageEditor.min.js.map
