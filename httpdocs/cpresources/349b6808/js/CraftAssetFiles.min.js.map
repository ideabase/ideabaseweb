{"version":3,"sources":["CraftAssetFiles.js"],"names":["plugin","$","extend","Craft","Redactor","PluginBase","title","apiTarget","icon","volumes","showModal","this","app","selection","save","assetSelectionModal","createElementSelectorModal","storageKey","sources","criteria","siteId","elementSiteId","onSelect","proxy","assets","transform","length","restore","i","asset","url","id","data","name","label","api","closeOtherModals","show","setVolumes","add"],"mappings":"AAAA,IAAIA,OAASC,EAAEC,UAAWC,MAAMC,SAASC,YACrCC,MAAO,OACPC,UAAW,mCACXC,KAAM,+BACNC,QAAS,KAETC,UAAW,WACPC,KAAKC,IAAIC,UAAUC,YAEqB,IAA7BH,KAAKI,oBACZJ,KAAKI,oBAAsBZ,MAAMa,2BAA2B,0BACxDC,WAAY,4BACZC,QAASP,KAAKF,QACdU,UAAWC,OAAQT,KAAKU,eACxBC,SAAUrB,EAAEsB,MAAM,SAASC,EAAQC,GAC/B,GAAID,EAAOE,OAAQ,CACff,KAAKC,IAAIC,UAAUc,UACnB,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAOE,OAAQE,IAAK,CACpC,IAAIC,EAAQL,EAAOI,GACfE,EAAMD,EAAMC,IAAM,UAAYD,EAAME,GACpCC,KAEJA,EAAK,QAAQH,EAAME,KACfD,IAAKA,EACLC,GAAIF,EAAME,GACVE,KAAMJ,EAAMK,OAGhBvB,KAAKC,IAAIuB,IAAI,qBAAsBH,MAG5CrB,MACHyB,kBAAkB,IAItBzB,KAAKI,oBAAoBsB,QAIjCC,WAAY,SAAU7B,GACtBE,KAAKF,QAAUA,KAMhBL,SADImC,IAAI,SAAU,kBAAmBvC","file":"CraftAssetFiles.min.js","sourcesContent":["var plugin = $.extend({}, Craft.Redactor.PluginBase, {\n    title: 'file',\n    apiTarget: 'plugin.craftAssetFiles.showModal',\n    icon: '<i class=\"re-icon-file\"></i>',\n    volumes: null,\n\n    showModal: function () {\n        this.app.selection.save();\n\n        if (typeof this.assetSelectionModal === 'undefined') {\n            this.assetSelectionModal = Craft.createElementSelectorModal('craft\\\\elements\\\\Asset', {\n                storageKey: 'RedactorInput.LinkToAsset',\n                sources: this.volumes,\n                criteria: {siteId: this.elementSiteId},\n                onSelect: $.proxy(function(assets, transform) {\n                    if (assets.length) {\n                        this.app.selection.restore();\n                        for (var i = 0; i < assets.length; i++) {\n                            var asset = assets[i],\n                                url = asset.url + '#asset:' + asset.id,\n                                data = {};\n\n                            data['asset'+asset.id] = {\n                                url: url,\n                                id: asset.id,\n                                name: asset.label\n                            };\n\n                            this.app.api('module.file.insert', data);\n                        }\n                    }\n                }, this),\n                closeOtherModals: false,\n            });\n        }\n        else {\n            this.assetSelectionModal.show();\n        }\n    },\n\n    setVolumes: function (volumes) {\n    this.volumes = volumes;\n}\n});\n\n(function($R) {\n    $R.add('plugin', 'craftAssetFiles', plugin);\n})(Redactor);"]}